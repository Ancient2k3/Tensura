-- Main Script --
local P1L = game:GetService("Players").LocalPlayer
local R1S = game:GetService("RunService")
local RP1 = game:GetService("ReplicatedStorage")
local PLRS = P1L:WaitForChild("PlayerScripts")
local M1D = RP1:WaitForChild("Modules")
local N1 = M1D:WaitForChild("Net")
local RE_1 = N1:WaitForChild("RE/RegisterAttack")
local RE_2 = N1:WaitForChild("RE/RegisterHit")
local LSC = PLRS:FindFirstChildOfClass("LocalScript")
local CHARs1 = workspace:WaitForChild("Characters")
local H1T

task.spawn(function()
    while not LSC do
        P1L.PlayerScripts.ChildAdded:Wait()
        LSC = PLRS:FindFirstChildOfClass("LocalScript")
    end
end)

_G.EnableFastAttack_Players = false
_G.SuperFastAttack_Players = false
_G.Method = 2
local Its_Disable_ATKPlayers, _WaitTime_Players

Its_Disable_ATKPlayers = false
_WaitTime_Players = 0.05

-- Function --
function AreYouAlive(C1H)
    local Hmoid = C1H:FindFirstChild("Humanoid")
    return Hmoid and Hmoid.Health > 0
end

function CreateProcess(Pz1, Distance)
    local BLADE1 = {}
    local YLP = CHARs1:GetChildren()

    for i = 1, #YLP do
        local ELT = YLP[i]
        local BzP = ELT.PrimaryPart

        if BzP and AreYouAlive(ELT) and (Pz1 - BzP.Position).Magnitude <= Distance then
            table.insert(BLADE1, {ELT, BzP})
        end
    end

    return BLADE1
end

function VLP4BLADE1(C1H, Distance)
    local Pz1 = C1H:GetPivot().Position
    Distance = Distance or 50

    return CreateProcess(Pz1, Distance)
end

function Run_NormalAttacking(C1H, CDF)
    local ERP1 = nil
    local BLADE1 = VLP4BLADE1(C1H)

    if #BLADE1 > 0 then
        ERP1 = BLADE1[1][2]

        RE_1:FireServer(CDF)
        if _G.Method == 1 then
            RE_2:FireServer(ERP1, BLADE1)
        elseif _G.Method == 2 then
            H1T(ERP1, BLADE1)
        end
    end
end

function RunSpecialFunction(CDF)
    if not AreYouAlive(P1L.Character) then return end
    
    local C1H = P1L.Character
    local EP1 = C1H:FindFirstChildOfClass("Tool")
    local ToolTip = EP1 and EP1.ToolTip
    
    if not EP1 or (ToolTip ~= "Gun" and ToolTip ~= "Melee" and ToolTip ~= "Blox Fruit" and ToolTip ~= "Sword") then
        return
    end
    
    local CDF = EP1:FindFirstChild("Cooldown") and EP1.Cooldown.Value or CDF

    Run_NormalAttacking(C1H, CDF)
end

local P1 = 0
R1S.RenderStepped:Connect(function()
    P1 += 1
    if P1 >= 2 then
        if getsenv then
            local S1, E2 = pcall(getsenv, LSC)
            if S1 and E2 then
                H1T = E2._G.SendHitsToServer
            end
        end
        P1 = 0
    end
end)

R1S.RenderStepped:Connect(function()
    if _G.EnableFastAttack_Players and not Its_Disable_ATKPlayers then
        if not _G.SuperFastAttack_Players then
            RunSpecialFunction(0.3)
        else
            RunSpecialFunction(0.0002)
        end
        wait(_WaitTime_Players)
    end
end)
