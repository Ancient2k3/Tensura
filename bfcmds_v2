-- Blox Fruits: Commands Scripts Fixed + Changed, HoangHien --
local _WS, _CG, _RlS, _RS, _TS, _StGui, _SGui, _GetFocusedButton, _GetCommands, _GetCorrectedCommands, _SettingsFrame, _SettingsScroll
local EndPoint, StartPoint, OnFocused_SlideOut, OnFocused_SlideIn, intBGC_All, col1, col2, col3
local _PLRS, _PLR, _Char, _Him, _He
local FA_VariableCheck_0, FA_Toggle, FA_Toggle_II, Cmdbar_ItsOnFocused, _SSCRL_Canvasmain, _ButtonHeight, _ButtonPadding, Its_SettingsUIEnable, numtest, thisisenable, intCLabel_Txc, _alreadyRunIYEdited

_WS = game:GetService("Workspace")
_CG = game:GetService("CoreGui")
_RlS = game:GetService("ReplicatedStorage")
_RS = game:GetService("RunService")
_TS = game:GetService("TweenService")
_StGui = game:GetService("StarterGui")

_PLRS = game:GetService("Players")
_PLR = _PLRS.LocalPlayer
_Char = _PLR.Character
_Him = _Char:WaitForChild("HumanoidRootPart")
_He = _Char:WaitForChild("Humanoid")

_G.Commands_Script_Language_Test = {}
numtest, thisisenable, intCLabel_Txc = 1, false, Color3.fromRGB(255, 255, 255)
FA_VariableCheck_0 = false
FA_Toggle = false
FA_Toggle_II = false
Cmdbar_ItsOnFocused = false
Its_SettingsUIEnable = false
_alreadyRunIYEdited = false
_SSCRL_Canvasmain = 0
_ButtonHeight = 25
_ButtonPadding = 2
EndPoint = UDim2.new(0, 0, 0.1, 0)
StartPoint = UDim2.new(-0.25, 0, 0.1, 0)
intBGC_All = Color3.fromRGB(0, 0, 0)

_SGui = Instance.new("ScreenGui", _CG)
_GetCommands = Instance.new("TextBox", _SGui)
_GetFocusedButton = Instance.new("TextButton", _GetCommands)
_GetCorrectedCommands = Instance.new("TextLabel", _GetCommands)
_SettingsFrame = Instance.new("Frame", _SGui)
_SettingsScroll = Instance.new("ScrollingFrame", _SettingsFrame)

OnFocused_SlideOut = _TS:Create(_GetCommands, TweenInfo.new(1, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut), {Position = EndPoint})
OnFocused_SlideIn = _TS:Create(_GetCommands, TweenInfo.new(1, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut), {Position = StartPoint})

_GetCommands.BackgroundTransparency = 0.8
_GetCommands.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
_GetCommands.Position = UDim2.new(-0.25, 0, 0.1, 0)
_GetCommands.Size = UDim2.new(0.25, 0, 0.065, 0)
_GetCommands.TextScaled = true
_GetCommands.TextSize = 9
_GetCommands.TextColor3 = Color3.fromRGB(0, 255, 0)
_GetCommands.Font = Enum.Font.Code
_GetCommands.Text = ""
_GetCommands.ClearTextOnFocus = true
_GetCommands.PlaceholderText = _G.Commands_Script_Language_Test[1] or "Commands ?"
_GetCommands.Visible = true

_GetFocusedButton.BackgroundTransparency = 0.8
_GetFocusedButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
_GetFocusedButton.Position = UDim2.new(1.02, 0, 0, 0)
_GetFocusedButton.Size = UDim2.new(0.15, 0, 1, 0)
_GetFocusedButton.TextScaled = true
_GetFocusedButton.TextSize = 9
_GetFocusedButton.TextColor3 = Color3.fromRGB(255, 255, 255)
_GetFocusedButton.Font = Enum.Font.Code
_GetFocusedButton.Text = _G.Commands_Script_Language_Test[2] or ">"
_GetFocusedButton.Visible = true

_GetCorrectedCommands.BackgroundTransparency = 1
_GetCorrectedCommands.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
_GetCorrectedCommands.Position = UDim2.new(0.02, 0, 1.02, 0)
_GetCorrectedCommands.Size = UDim2.new(0.96, 0, 0.45, 0)
_GetCorrectedCommands.TextScaled = true
_GetCorrectedCommands.TextSize = 8.5
_GetCorrectedCommands.TextColor3 = Color3.fromRGB(255, 255, 255)
_GetCorrectedCommands.Font = Enum.Font.Code
_GetCorrectedCommands.Text = _G.Commands_Script_Language_Test[4] or "</>"
_GetCorrectedCommands.Visible = true

-- Settings Hidden Frame --

_SettingsFrame.BackgroundTransparency = 0.8
_SettingsFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
_SettingsFrame.Position = UDim2.new(0.45, 0, 0.2, 0)
_SettingsFrame.Size = UDim2.new(0.25, 0, 0.6, 0)
_SettingsFrame.Active = true
_SettingsFrame.Draggable = true
_SettingsFrame.Visible = Its_SettingsUIEnable

_SettingsScroll.BackgroundTransparency = 0.9
_SettingsScroll.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
_SettingsScroll.Position = UDim2.new(0.05, 0, 0.05, 0)
_SettingsScroll.Size = UDim2.new(0.9, 0, 0.9, 0)
_SettingsScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
_SettingsScroll.ScrollBarThickness = 0.1
_SettingsScroll.Visible = true

-- End --

function _MouseButton1Click(Name, Scripts)
    Name.MouseButton1Click:Connect(function()
        Scripts()
    end)
end

function _FocusLost(Name, Var, Scripts)
    Name.FocusLost:Connect(function(Var)
        if Var then
            Scripts()
        end
    end)
end

function _Notice(Tt, tx, dur, x)
    if x == "SendNotification" then
        _StGui:SetCore(x, {
            Title = Tt,
            Text = tx,
            Duration = dur,
        })
    elseif x == "DevConsoleVisible" then
        _StGui:SetCore(x, true)
    end
end

function _InvokeServer(Name, Worlds, ...)
    local _ArGs_Text = {...}
    _RlS.Remotes[Name]:InvokeServer(unpack(_ArGs_Text))
    task.spawn(function()
        _Notice("World Commands", "Teleportation to " .. Worlds .. ". !", 1, "SendNotification")
    end)
end

function _PasteScripts(url, scripts)
    local success, result = pcall(function()
        loadstring(game:HttpGet(url))()
    end)
    
    if success then
        scripts()
    else
        print(result .. " <failed>!")
    end
end

local EveryCmds_nAlliase = {
    ["reset"] = {"reset", "re"},
    ["console"] = {"console", "co"},
    ["speed"] = {"speed", "sp"},
    ["dash"] = {"dash", "da"},
    ["fastattack"] = {"fastattack", "fa"},
    ["superfastattack"] = {"superfastattack", "sfa"},
    ["iyedited"] = {"iyedited", "iy"},
    ["travelingsea"] = {"travelingsea", "sea", "worlds"},
    ["suggestiontextcolor"] = {"suggestiontextcolor", "stc"},
    ["settings"] = {"settings", "se", "s"}
}

function EveryCommands()
    local GetWords = _GetCommands.Text
    local Scripts_Cmds = {}
    
    for wis in string.gmatch(GetWords, "%S+") do
        table.insert(Scripts_Cmds, wis)
    end
    
    if table.find(EveryCmds_nAlliase["reset"], Scripts_Cmds[1]) then
        -- _He:ChangeState(Enum.HumanoidStateType.Dead)
        if _PLR.Character and _PLR.Character:FindFirstChild("Humanoid") then
            _PLR.Character.Humanoid.Health = 0
        end
        _Notice("Commands", "Character Reseted!", 1, "SendNotification")
    elseif table.find(EveryCmds_nAlliase["iyedited"], Scripts_Cmds[1]) then
        if not _alreadyRunIYEdited then
            _alreadyRunIYEdited = true
            local success, result = pcall(function()
                loadstring(game:HttpGet("https://raw.githubusercontent.com/HoangHien2k3/Tensura/refs/heads/edit/Scripts/InfiniteYield-Edited/Source_Edited.luau"))()
            end)
            if success then
                _Notice("IY-Edited", "Successfully loaded!", 1, "SendNotification")
            else
                _Notice("IY-Edited", "Failed load, error: " .. result, 1, "SendNotification")
            end
        else
            _Notice("Commands", "This command should be only used one time...", 1, "SendNotification")
        end
    elseif table.find(EveryCmds_nAlliase["console"], Scripts_Cmds[1]) then
        _Notice("nothing", "nothing", 1, "DevConsoleVisible")
        _Notice("Commands", "Developer Console Opened!", 1, "SendNotification")
    elseif table.find(EveryCmds_nAlliase["speed"], Scripts_Cmds[1]) then
        local myCharacterIn_WS = _WS.Characters[_PLR.Name]
        if myCharacterIn_WS then
            if Scripts_Cmds[2] then
                local new_SpeedValue = tonumber(Scripts_Cmds[2])
                if new_SpeedValue >= 0.01 then
                    myCharacterIn_WS:SetAttribute("SpeedMultiplier", new_SpeedValue)
                    _Notice("Commands", "Running & Walking speed changed/set to: " .. new_SpeedValue, 1, "SendNotification")
                else
                    _Notice("Commands", "Running & Walking speed can't be set 0 or lower!", 1, "SendNotification")
                end
            elseif Scripts_Cmds[2] == "max" then
                myCharacterIn_WS:SetAttribute("SpeedMultiplier", 10)
                _Notice("Commands", "Running & Walking speed set maxium!", 1, "SendNotification")
            elseif Scripts_Cmds[2] ~= "" or Scripts_Cmds[2] == " " then
                _Notice("Commands", "Running & Walking speed try typing in a value number!", 1, "SendNotification")
            end
        end
    elseif table.find(EveryCmds_nAlliase["dash"], Scripts_Cmds[1]) then
        local myCharacterIn_WS = _WS.Characters[_PLR.Name]
        if myCharacterIn_WS then
            if Scripts_Cmds[2] then
                local new_DashDistanceValue = tonumber(Scripts_Cmds[2])
                if new_DashDistanceValue >= 0.01 then
                    myCharacterIn_WS:SetAttribute("DashLength", new_DashDistanceValue)
                    _Notice("Commands", "Dash Distance increase to: " .. new_DashDistanceValue, 1, "SendNotification")
                else
                    _Notice("Commands", "Dash Distance can't be set 0 or lower!", 1, "SendNotification")
                end
            elseif Scripts_Cmds[2] == "max" then
                myCharacterIn_WS:SetAttribute("DashLength", 900)
                _Notice("Commands", "Dash Distance set maxium!", 1, "SendNotification")
            elseif Scripts_Cmds[2] ~= "" or Scripts_Cmds[2] == " " then
                _Notice("Commands", "Dash Distance try typing in a dash value number!", 1, "SendNotification")
            end
        end
    elseif table.find(EveryCmds_nAlliase["fastattack"], Scripts_Cmds[1]) then
        if not FA_VariableCheck_0 then
            FA_VariableCheck_0 = true
            _Notice("Commands", "Hold on a seconds, Loading Scripts...", 1, "SendNotification")
            _PasteScripts("https://raw.githubusercontent.com/NganHa2k3/Tensura/refs/heads/powerful/FA_QuickAttacks", function()
                _Notice("Commands", "Successfully Loaded Scripts!", 1, "SendNotification")
            end)
            FastAttack_Status()
        else
            _Notice("Commands", "Already Loaded Scripts!", 1, "SendNotification")
            FastAttack_Status()
        end
    elseif table.find(EveryCmds_nAlliase["superfastattack"], Scripts_Cmds[1]) then
        if not FA_VariableCheck_0 then
            FA_VariableCheck_0 = true
            _Notice("Commands", "Hold on a seconds, Loading Scripts...", 1, "SendNotification")
            _PasteScripts("https://raw.githubusercontent.com/NganHa2k3/Tensura/refs/heads/powerful/FA_QuickAttacks", function()
                _Notice("Commands", "Successfully Loaded Scripts!", 1, "SendNotification")
            end)
            SuperFastAttack_Status()
        else
            _Notice("Commands", "Already Loaded Scripts!", 1, "SendNotification")
            SuperFastAttack_Status()
        end
    elseif table.find(EveryCmds_nAlliase["travelingsea"], Scripts_Cmds[1]) then
        if Scripts_Cmds[2] == "1" then
            _InvokeServer("CommF_", "First Sea", "TravelMain")
        elseif Scripts_Cmds[2] == "2" then
            _InvokeServer("CommF_", "Second Sea", "TravelDressora")
        elseif Scripts_Cmds[2] == "3" then
            _InvokeServer("CommF_", "Final Sea", "TravelZou")
        end
    elseif table.find(EveryCmds_nAlliase["suggestiontextcolor"], Scripts_Cmds[1]) then
        if #Scripts_Cmds < 4 then
            _Notice("Theme", "Missing value! Please do 3_RGB color values.", 1, "SendNotification")
        else
            local _ArGs_II = tonumber(Scripts_Cmds[2])
            local _ArGs_III = tonumber(Scripts_Cmds[3])
            local _ArGs_IV = tonumber(Scripts_Cmds[4])
            
            if _ArGs_II and _ArGs_III and _ArGs_IV then
                _GetCorrectedCommands.TextColor3 = Color3.fromRGB(_ArGs_II, _ArGs_III, _ArGs_IV)
                _Notice("Theme", "Suggestion Text Theme Color Changed to: " .. Scripts_Cmds[2] .. " " .. Scripts_Cmds[3] .. " " .. Scripts_Cmds[4], 1, "SendNotification")
            else
                _Notice("Theme", "Please do a valid 3_RGB values.", 1, "SendNotification")
            end
        end
    elseif table.find(EveryCmds_nAlliase["settings"], Scripts_Cmds[1]) then
        if not Its_SettingsUIEnable then
            Its_SettingsUIEnable = true
            _Notice("Settings", "Settings UI Opened!", 1, "SendNotification")
        else
            Its_SettingsUIEnable = false
            _Notice("Settings", "Settings UI Closed!", 1, "SendNotification")
        end
        _SettingsFrame.Visible = Its_SettingsUIEnable
    end
    
    _GetCommands.Text = ""
end

function FastAttack_Status()
    if not FA_Toggle and not FA_Toggle_II then
        FA_Toggle = true
        _G.EnableFastAttack = true
        _Notice("Commands", "Fast Attacking Normal is On/Activated!", 1, "SendNotification")
    else
        FA_Toggle = false
        _G.EnableFastAttack = false
        _Notice("Commands", "Fast Attacking Normal is Off/Deactivated!", 1, "SendNotification")
    end
end

function SuperFastAttack_Status()
    if not FA_Toggle_II and not FA_Toggle then
        FA_Toggle_II = true
        _G.EnableFastAttack = true
        _G.SuperFastAttack = true
        _Notice("Commands", "Fast Attacking Overpower is On/Activated!", 1, "SendNotification")
    else
        FA_Toggle_II = false
        _G.EnableFastAttack = false
        _G.SuperFastAttack = false
        _Notice("Commands", "Fast Attacking Overpower is Off/Deactivated!", 1, "SendNotification")
    end
end

function CorrectedEveryCommands(boolean_ix)
    local GetCommands_Words = _GetCommands.Text:lower()
    local Matching_Words, Matching_Words_I = nil, nil

    if GetCommands_Words ~= "" then
        for command, aliases in pairs(EveryCmds_nAlliase) do
            for _, alias in ipairs(aliases) do
                if alias:lower():find(GetCommands_Words) then
                    Matching_Words = command
                    Matching_Words_I = command .. ", " .. table.concat({table.unpack(aliases, 2)}, ", ")
                    break
                end
            end
            if Matching_Words then break end
        end
    else
        Matching_Words = ""
        Matching_Words_I = "</>"
    end

    if boolean_ix then
        if Matching_Words_I then
            _GetCorrectedCommands.Text = Matching_Words_I
        else
            _GetCorrectedCommands.Text = _G.Commands_Script_Language_Test[4] or "Seems like it's not a valid command"
        end
    else
        if Matching_Words then
            _GetCommands.Text = Matching_Words
        else
            _GetCommands.Text = ""
        end
    end
end

function _AddCornerUI(Name, Radius)
    local UIC_Zero = Instance.new("UICorner", Name)
    UIC_Zero.CornerRadius = UDim.new(Radius, 0)
end

function _ThemeChanged(RGB_Color)
    _GetCommands.BackgroundColor3 = RGB_Color
    _GetCorrectedCommands.BackgroundColor3 = RGB_Color
    _GetFocusedButton.BackgroundColor3 = RGB_Color
    _SettingsFrame.BackgroundColor3 = RGB_Color
    _SettingsScroll.BackgroundColor3 = RGB_Color
end

function _AddedSettings_NormalB(NameSetting, Scripts)
    local _SpecialNew_Button = Instance.new("TextButton", _SettingsScroll)
    _SpecialNew_Button.BackgroundTransparency = 0
    _SpecialNew_Button.BackgroundColor3 = intBGC_All
    _SpecialNew_Button.Position = UDim2.new(0.02, 0, 0, _SSCRL_Canvasmain + _ButtonPadding)
    _SpecialNew_Button.Size = UDim2.new(0.96, 0, 0, _ButtonHeight)
    _SpecialNew_Button.TextScaled = true
    _SpecialNew_Button.TextSize = 9
    _SpecialNew_Button.TextColor3 = Color3.fromRGB(255, 255, 255)
    _SpecialNew_Button.Font = Enum.Font.Code
    _SpecialNew_Button.Text = NameSetting
    _SpecialNew_Button.Visible = true
    _AddCornerUI(_SpecialNew_Button, 0.2)
    _MouseButton1Click(_SpecialNew_Button, function()
        Scripts()
    end)
    _SSCRL_Canvasmain = _SSCRL_Canvasmain + _ButtonHeight + _ButtonPadding
    _SettingsScroll.CanvasSize = UDim2.new(0, 0, 0, _SSCRL_Canvasmain)
end

_MouseButton1Click(_GetFocusedButton, function()
    if _GetFocusedButton.Text == "<" and _GetCommands.Position == EndPoint then
        _GetFocusedButton.Text = ">"
        print("You're used button to closed activated cmdbar =))")
        OnFocused_SlideIn:Play()
    else
        _GetCommands:CaptureFocus()
    end
end)

_FocusLost(_GetCommands, enterPressed, function()
    print("You're leave activated cmdbar... and have done something!")
    Cmdbar_ItsOnFocused = false
    OnFocused_SlideIn:Play()
    _GetFocusedButton.Text = _G.Commands_Script_Language_Test[2] or ">"
    -- CorrectedEveryCommands(false)
    pcall(EveryCommands)
end)

_GetCommands.Focused:Connect(function()
    print("You're on activated cmdbar, now waiting...")
    Cmdbar_ItsOnFocused = true
    OnFocused_SlideOut:Play()
    _GetFocusedButton.Text = _G.Commands_Script_Language_Test[3] or "<"
end)

_RS.RenderStepped:Connect(function(deltaTime)
    if Cmdbar_ItsOnFocused then
        CorrectedEveryCommands(true)
    end
end)

_AddCornerUI(_GetCommands, 0.2)
_AddCornerUI(_GetFocusedButton, 0.2)
_AddCornerUI(_GetCorrectedCommands, 0.2)
_AddCornerUI(_SettingsFrame, 0.05)
_AddCornerUI(_SettingsScroll, 0.2)

_AddedSettings_NormalB("Theme: Default", function()
    _ThemeChanged(intBGC_All)
    _Notice("Theme", "Scripts UI Background Color it's set as Default!", 1, "SendNotification")
end)

_AddedSettings_NormalB("Theme: Skyblue/Rain", function()
    _ThemeChanged(Color3.fromRGB(0, 200, 200))
    _Notice("Theme", "Scripts UI Background Color it's set as Skyblue!", 1, "SendNotification")
end)

_AddedSettings_NormalB("Theme: Crimson/Red", function()
    _ThemeChanged(Color3.fromRGB(255, 0, 0))
    _Notice("Theme", "Scripts UI Background Color it's set as Crimson!", 1, "SendNotification")
end)

_AddedSettings_NormalB("Suggestion TextColor: Rainbow", function()
    -- numtest += 1
    if not thisisenable then
        thisisenable = true
        _Notice("Theme", "Suggestion UI Text Color it's set to Rainbow!", 1, "SendNotification")
    else
        thisisenable = false
        task.delay(0.2, function()
            _GetCorrectedCommands.TextColor3 = intCLabel_Txc
            _Notice("Theme", "Suggestion UI Text Color it's set as Default!", 1, "SendNotification")
        end)
    end
    
    while thisisenable do
        col1 = math.random(1, 255)
        col2 = math.random(1, 255)
        col3 = math.random(1, 255)
        _GetCorrectedCommands.TextColor3 = Color3.fromRGB(col1, col2, col3)
        wait(0.24)
    end
end)
